import time
from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as cond
from selenium.webdriver.common.by import By
import logging
LOGGER = logging.getLogger(__name__)

def launch_url():
    options = webdriver.ChromeOptions()
    options.add_experimental_option('useAutomationExtension', False)
    options.add_argument("--start-maximized")
    options.add_argument(r'user-data-dir=C:\\Users\\athangaraj001\\AppData\\Local\\Google\\Chrome\\User Data')
    driver = webdriver.Chrome(
        options=options,
        executable_path=r'C:\\Users\\athangaraj001\\PycharmProjects\\ADAPT_Python\\chromedriver.exe')
    driver.get("https://gasenablement2345--qa02.lightning.force.com")
    # pickle.dump(driver.get_cookies(), open(r"C:\\Users\\athangaraj001\\PycharmProjects\\ADAPT_Python\\GoogleCookies.pkl", "wb"))

    LOGGER.info('URL launched successfully')
    driver.implicitly_wait(5)
    driver.find_element_by_xpath("//input[@id='username']").send_keys('peter.kennedy2@nationalgrid.com.qa02')
    driver.find_element_by_xpath("//input[@id='password']").send_keys('Salesforce02!')
    driver.find_element_by_xpath("//input[@id='Login']").click()
    print('wait')

def search_billing():
    options = webdriver.ChromeOptions()
    # options.add_experimental_option('useAutomationExtension', False)
    options.add_experimental_option("debuggerAddress", "127.0.0.1:9222")
    options.add_argument("--start-maximized")
    driver = webdriver.Chrome(
        options=options,
        executable_path=r'C:\\Users\\athangaraj001\\PycharmProjects\\ADAPT_Python\\chromedriver.exe')
    list = [5000727001,5000922006,5001460023,5001990008,5002001019,5002902002,5003143007,5003192046,5004334002,5005324117,5005373012,5006024036,5006644038,5006663015,5008069024,5008323087,5009273022,5009482012,5009763012,5010493021,5010944023,5011414006,5011567020,5013016099,5013333013,5013434015,5013673003,5013864022,5014062040,5014262031,5014372096,5014373057,5014474022,5014663029,5015134018,5015173042,5016062048,5016183088,5016473050,5016904023,5017172034,5017462060,5017513017,5017684020,5017873027,5018135044,5018544025,5018624028,5018662028,5018784065,5018933022,5019854039,5019863029,5019924081,5020090014,5020265048,5020304031,5020454045,5020623246,5020913012,5021516017,5021522024,5021523049,5021524028,5021525016,5021527056,5021528008,5021529023,5021530142,5021531032,5021532137,5021533009,5021534033,5021536000,5021537007,5021538013,5021539001,5021541001,5021542008,5021543005,5021544002,5021545009,5021546006,5021549007,5021550000,5021551007,5021555103,5021557018,5021558024,5021559012,5021560006,5021562028,5021564022,5021566008,5021567005,5021568002,5021569009,5021571018,5021574037,5021576004,5021577001,5021579005,5021580017,5021581005,5021582057,5021583018,5021584015,5021585058,5021587007,5021588077,5021589092,5021590022,5021591065,5021592044,5021593050,5021594075,5021595027,5021596042,5021597012,5021598037,5021599123,5021600041,5021601002,5021602027,5021603006,5021605091,5021606007,5021607004,5021608001,5021609008,5021610092,5021611008,5021612103,5021613137,5021615079,5021616049,5021617126,5021618098,5021619031,5021620150,5021621004,5021622001,5021623062,5021624130,5021625244,5021626090,5021627006,5021628012,5021629055,5021633102,5021634092,5021635035,5021636087,5021637002,5021638198,5021640018,5021641097,5021642003,5021643019,5021644007,5021645004,5021646001,5021647026,5021648121,5021651048,5021652018,5021653006,5021654003,5021655108,5021656007,5021657004,5021658001,5021659017,5021660029,5021661026,5021662005,5021663048,5021664009,5021665015,5021666003,5021667028,5021668025,5021669040,5021670043,5021671068,5021672001,5021673008,5021675002,5021676018,5021677006,5021678030,5021679135,5021680030,5021681091,5021682007,5021683086,5021684001,5021685017,5021686023,5021687020,5021688054,5021689079,5021690009,5021691051,5021693108,5021694007,5021695086,5021696038,5021697026,5021698103,5021699002,5021700091,5021701007,5021702004,5021703001,5021704017,5021705014,5021706020,5021707009,5021708006,5021709003,5021710006,5021711003,5021712000,5021713007,5021714004,5021715001,5021716053,5021717014,5021718011,5021719009,5021720002,5021721018,5021722060,5021723003,5021724000,5021725007,5021726004,5021727001,5021728044,5021729005,5021730008,5021731041,5021732011,5021733009,5021734015,5021735076,5021736000,5021737016,5021738068,5021739092,5021740031,5021741038,5021742008,5021743005,5021744039,5021745036,5021747003,5021748037,5021749016,5021750082,5021751034,5021752086,5021753092,5021754026,5021756100,5021757063,5021758015,5021759003,5000727001,5000922006,5001460023,5001990008,5002001019,5002902002,5003143007,5003192046,5004334002,5005324117,5005373012,5006024036,5006644038,5006663015,5008069024,5008323087,5009273022,5009482012,5009763012,5010493021,5010944023,5011414006,5011567020,5013016099,5013333013,5013434015,5013673003,5013864022,5014062040,5014262031,5014372096,5014373057,5014474022,5014663029,5015134018,5015173042,5016062048,5016183088,5016473050,5016904023,5017172034,5017462060,5017513017,5017873027,5018135044,5018544025,5018624028,5018662028,5018784065,5018933022,5019854039,5019863029,5019924081,5020265048,5020304031,5020454045,5020623246,5020913012,5021522024,5021523049
]
    for i in list:
        time.sleep(2)
        driver.find_element_by_xpath('(//input[@placeholder="Enter CSS/CRIS Id"])[2]').clear()
        driver.find_element_by_xpath('(//input[@placeholder="Enter CSS/CRIS Id"])[2]').send_keys(i)
        driver.find_element_by_xpath('(//*[@id="billingAccount_Div"]/div[1]/div/div/button/lightning-primitive-icon)[2]').click()
        time.sleep(2)
        WebDriverWait(driver, 20).until(cond.invisibility_of_element((By.XPATH,"//lightning-spinner")))
        # print(driver.find_element_by_xpath('//a[@id="recordLink"]').text)
        try:
            driver.find_element_by_xpath('//a[@id="recordLink"]').click()
        except:
            print('The related premise profile does not exist with either premise CSS/CRIS ref Id sent from target system')
            continue
        time.sleep(3)
        cases = driver.find_element_by_xpath("(//span[@title='Cases']//following-sibling::span)[1]").text
        time.sleep(1)
        wos = driver.find_element_by_xpath("//span[@class='custom-title-class']").text
        time.sleep(1)
        print(str(i)+' --> Cases '+str(cases)+" "+str(wos))
        driver.find_element_by_xpath("//button[@type='button' and contains(@title,'Close')]").click()
        time.sleep(2)

search_billing()